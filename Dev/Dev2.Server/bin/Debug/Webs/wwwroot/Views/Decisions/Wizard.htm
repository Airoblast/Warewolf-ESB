<div id="container">
    <div class="float-left">

        <div id="header" class="ui-dialog-titlebar ui-widget-header ui-helper-clearfix" style="padding: 5px; font-size: 1.2em;">
            Decision Flow
        </div>

        <div id="body" class="ui-widget-content">
            <form id="mainForm">
                <div id="mainFormError" class="error" style="display: none; text-align: left; margin-top: 1em; margin-left: 1em; float: left;">
                    <img src="../images/warning.png" alt="Warning!" width="24" height="24" class="icon" />
                    <span id="Dev2Msg">You missed some fields.The have been highlighted below.</span>
                </div>
                <div class="decision-form">
                    <div>
                        <div class="field">
                            <label class="wideLabel">&nbsp; Evaluates a statement to True or False</label>
                        </div>

                        <div class="button-bar">
                            <!--<span style="font-size:18px; float:left; margin-left:20px;">
								If: 
							</span>-->
                            <button name="addRow" id="addRow" data-bind="click: addRow" title="Add a new statement">Add Statement </button>
                        </div>

                        <!-- KO Template -->
                        <div class="decision-wrapper" id="decisionView">
                            <div data-bind="template: { foreach: data.TheStack, afterAdd: afterRowAdd, afterRender: afterRowRender }" id="decisionList" style="width: 100%;">
                                <div id="decisionRow" style="height: 37px;">
                                    &nbsp; If :
									<input type="text" name="Col1" id="Col1" data-bind="value: Col1, valueUpdate: 'afterkeydown', visible: PopulatedColumnCnt > 0" class="veryShortField required" /><!--, event:{ keydown: $parent.onKeyPress}"-->

                                    <select data-bind="options: $parent.data.decisionFunctions, value: EvaluationFn,optionsText: 'displayValue', optionsValue: 'optionValue', event:{ change: $parent.rowChanged}" class="shortField required">
                                    </select>

                                    <input type="text" name="Col2" id="Col2" data-bind="value : Col2, valueUpdate: 'afterkeydown', visible: PopulatedColumnCnt == 2" class="veryShortField required" />

                                    <span data-bind="visible: PopulatedColumnCnt == 3">
                                        <input type="text" name="Col2a" id="Col2a" data-bind="value: Col2, valueUpdate: 'afterkeydown'" class="veryShortField required" />
                                        And
										<input type="text" name="Col3" id="Col3" data-bind="value: Col3, valueUpdate: 'afterkeydown'" class="veryShortField required" />
                                    </span>

                                    <span class="floatRight">
                                        <!-- data-bind="click: $parent.removeRow, visible: $index() >= 1" -->
                                        <button name="removeRow" id="removeRow" data-bind="click: $parent.removeRow, visible: $parent.ShowDelete($index())" title="Remove this statement">
                                            <img src="Images/cross.png" height="14" width="14" />
                                        </button>
                                    </span>
                                </div>
                            </div>

                        </div>

                        <div style="margin-top: 20px; width: 100%; float: left;">
                            <div style="margin-left: -89px;">
                                <label for="trueArmText" name="trueArm" id="trueArm">True arm text </label>
                                <input type="text" name="trueArmText" id="trueArmText" class="veryShortField" data-bind="value: data.TrueArmText" />
                            </div>

                            <div style="margin-left: -85px;">
                                <label for="falseArmText" name="falseArm" id="falseArm">False arm text</label>
                                <input style="margin-left: -4px"type="text" name="falseArmText" id="falseArmText" class="veryShortField" data-bind="value: data.FalseArmText" />
                            </div>

                        </div>

                        <div class="button-bar">
                            <span style="float: left; width: 290px;">
                                <input type="checkbox" name="Mode" id="Mode" class="decision-mode" data-bind="checked: data.IsAnd, click: toggleMode" />
                                <label class="decision-mode-text">Require All decisions to be True</label>
                            </span>
                            <span>
                                <button tabindex="7" type="submit" name="save" id="saveButton" data-bind="click: save">Done</button>
                                <button tabindex="8" type="button" name="cancel" id="cancelButton" data-bind="click: cancel">Cancel</button>
                            </span>
                        </div>


                    </div>
            </form>
        </div>
    </div>
</div>
<div id="saveDialogContainer">
</div>

<!-- Import Model  -->
<script type="text/javascript" src="../Scripts/Decisions/DecisionModel.js"></script>

<script type="text/javascript">

    // build model
    var vm = new DecisionViewModel();

    // load model
    vm.Load();

    // apply model
    ko.applyBindings(vm);

</script>

