<div id="container" style="margin: 10px; width: 1000px">
    <div id="serviceForm">
        <div id="tabs" style="height: 510px">
            <ul>
                <li><a href="#tabs-1" data-bind="text: title"></a></li>
                <li><a href="#tabs-2">Defaults and Mapping</a></li>
            </ul>
            <div id="tabs-1" style="padding: 10px; margin: 0 auto;">
                <div style="float: left; width: auto; padding-right: 10px; border-right: #E2E2E2 solid 1px;">
                    <div style="height: 80px">
                        <h4>1. Select source</h4>
                        <div>
                            <select id="source" data-bind="options: sources, value: data.source, optionsText: 'ResourceName', optionsCaption : 'Choose...'"></select>
                            <button tabindex="6" type="button" name="test" id="editSourceButton" data-bind="click: editSource">...</button>
                            <button tabindex="6" type="button" name="test" id="newSourceButton" data-bind="click: newSource">New</button>
                        </div>
                    </div>
                    <div>
                        <h4 style="float: left; margin-top: 1em">2. Select action</h4>
                        <div style="float: right">
                            <img src="images/search.png" alt="Search" width="16" height="16" class="icon" />
                            <input tabindex="1" maxlength="20" type="text" name="sourceMethodSearchTerm" id="sourceMethodSearchTerm" placeholder="Search" autocomplete="off" style="width: 10em" data-bind="value: sourceMethodSearchTerm, valueUpdate: 'afterkeydown'" />
                        </div>
                    </div>
                    <div id="sourceMethodsScrollBox" class="scrollable" style="height: 310px; width: auto; clear: both;">
                        <ol class="selectable" id="sourceMethods" data-bind="foreach: sourceMethodSearchResults">
                            <li class="selectable">
                                <span style="margin-left: 0.5em" data-bind="text: Name"></span>
                            </li>
                        </ol>
                    </div>
                </div>

                <div style="float: left; width: auto; padding-left: 10px;">
                    <div class="help-text help-text-min" style="width: 515px; height: 73px" data-bind="html: helpText">
                    </div>
                    <h4 style="margin-top: 1em;">3. Test <span data-bind="text: data.methodName"></span></h4>
                    <div style="margin-top: 0.5em;">
                        <div class="box-border box-background" style="border-bottom: 0 none">
                            <table class="input-param">
                                <thead>
                                    <tr>
                                        <th class="input-param-name">Input</th>
                                        <th>Test Data</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                        <div id="inputsTable">
                            <div class="box-border box-background" style="height: 255px; width: 520px; overflow-y: scroll; overflow-x: hidden">
                                <table class="input-param">
                                    <tbody data-bind="foreach: data.methodParameters">
                                        <tr>
                                            <td class="input-param-name" data-bind="text: Name, attr: { title: Name}"></td>
                                            <td class="input-param-value">
                                                <textarea data-bind="val: Value"></textarea>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="button-bar" style="margin: 3px 0 0 0;">
                                <button tabindex="8" type="button" name="cancel" id="testButton" data-bind="click: testAction, jEnable: isFormValid">Test</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="tabs-2">
            </div>
        </div>
        <div class="button-bar">
            <button tabindex="7" type="submit" name="ok" id="okButton" data-bind="click: save, jEnable: isFormValid">Ok</button>
            <button tabindex="8" type="button" name="cancel" id="cancelButton" data-bind="click: cancel">Cancel</button>
        </div>
    </div>
</div>
<div id="saveDialogContainer">
</div>
<div id="testDialogContainer" title="Test Data">
    <div id="testData" class="scrollable" style="height: 400px;" data-bind="html: data.testData">
        
    </div>
</div>

<script src="Scripts/Sources/ServiceViewModel.js"></script>
<script type="text/javascript">
    //var serviceViewModel = new SerivceViewModel("{8A49D826-0B3E-4DB5-8D01-490A75A1B698}", "SqlDatabase");        
    var viewModel = new SerivceViewModel(null, "SqlDatabase");

    $("#testDialogContainer").dialog({
        resizable: false,
        autoOpen: false,
        modal: true,
        width: 600,
        buttons: {
            "Close": function () {
                $(this).dialog("close");
            }
        }
    });
    
    // inject SaveDialog
    $("#saveDialogContainer").load("Views/Dialogs/SaveDialog.htm", function () {
        $("button").button();
    });

    $(function () {
        // apply jquery-ui themes
        $("button").button();
        $("#tabs").tabs();

        ko.applyBindings(viewModel, document.getElementById("serviceForm"));
    });

</script>

